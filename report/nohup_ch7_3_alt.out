Sequential(
  (0): Sequential(
    (0): Conv2d(1, 96, kernel_size=(11, 11), stride=(4, 4))
    (1): ReLU()
    (2): Conv2d(96, 96, kernel_size=(1, 1), stride=(1, 1))
    (3): ReLU()
    (4): Conv2d(96, 96, kernel_size=(1, 1), stride=(1, 1))
    (5): ReLU()
  )
  (1): MaxPool2d(kernel_size=3, stride=2, padding=0, dilation=1, ceil_mode=False)
  (2): Sequential(
    (0): Conv2d(96, 256, kernel_size=(5, 5), stride=(1, 1), padding=(2, 2))
    (1): ReLU()
    (2): Conv2d(256, 256, kernel_size=(1, 1), stride=(1, 1))
    (3): ReLU()
    (4): Conv2d(256, 256, kernel_size=(1, 1), stride=(1, 1))
    (5): ReLU()
  )
  (3): MaxPool2d(kernel_size=3, stride=2, padding=0, dilation=1, ceil_mode=False)
  (4): Sequential(
    (0): Conv2d(256, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): ReLU()
    (2): Conv2d(384, 384, kernel_size=(1, 1), stride=(1, 1))
    (3): ReLU()
    (4): Conv2d(384, 384, kernel_size=(1, 1), stride=(1, 1))
    (5): ReLU()
  )
  (5): MaxPool2d(kernel_size=3, stride=2, padding=0, dilation=1, ceil_mode=False)
  (6): Dropout(p=0.5, inplace=False)
  (7): Sequential(
    (0): Conv2d(384, 10, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): ReLU()
    (2): Conv2d(10, 10, kernel_size=(1, 1), stride=(1, 1))
    (3): ReLU()
    (4): Conv2d(10, 10, kernel_size=(1, 1), stride=(1, 1))
    (5): ReLU()
  )
  (8): AdaptiveAvgPool2d(output_size=(1, 1))
  (9): Flatten()
)
Sequential      output shape:	 torch.Size([1, 96, 54, 54])
MaxPool2d       output shape:	 torch.Size([1, 96, 26, 26])
Sequential      output shape:	 torch.Size([1, 256, 26, 26])
MaxPool2d       output shape:	 torch.Size([1, 256, 12, 12])
Sequential      output shape:	 torch.Size([1, 384, 12, 12])
MaxPool2d       output shape:	 torch.Size([1, 384, 5, 5])
Dropout         output shape:	 torch.Size([1, 384, 5, 5])
Sequential      output shape:	 torch.Size([1, 10, 5, 5])
AdaptiveAvgPool2d output shape:	 torch.Size([1, 10, 1, 1])
Flatten         output shape:	 torch.Size([1, 10])
training on cuda:0
Epoch [0/100]: 100%|█████| 469/469 [00:27<00:00, 16.90it/s, acc=0.14, loss=2.27]
Train Loss:2.2661  Train Acc: 0.1404
Val Loss:2.1208  Val Acc:0.2542
Train and val complete in 0m 28s
Epoch [1/100]: 100%|████| 469/469 [00:27<00:00, 17.04it/s, acc=0.277, loss=1.91]
EarlyStopping counter: 1 out of 10
Train Loss:1.9096  Train Acc: 0.2771
Val Loss:2.3124  Val Acc:0.1032
Train and val complete in 0m 55s
Epoch [2/100]: 100%|████| 469/469 [00:28<00:00, 16.71it/s, acc=0.487, loss=1.35]
Train Loss:1.3530  Train Acc: 0.4871
Val Loss:0.7392  Val Acc:0.7199
Train and val complete in 1m 24s
Epoch [3/100]: 100%|███| 469/469 [00:28<00:00, 16.65it/s, acc=0.734, loss=0.704]
Train Loss:0.7040  Train Acc: 0.7339
Val Loss:0.5633  Val Acc:0.7899
Train and val complete in 1m 52s
Epoch [4/100]: 100%|████| 469/469 [00:27<00:00, 16.97it/s, acc=0.512, loss=1.35]
EarlyStopping counter: 1 out of 10
Train Loss:1.3504  Train Acc: 0.5119
Val Loss:0.6961  Val Acc:0.7206
Train and val complete in 2m 20s
Epoch [5/100]: 100%|███| 469/469 [00:27<00:00, 16.88it/s, acc=0.759, loss=0.655]
Train Loss:0.6550  Train Acc: 0.7586
Val Loss:0.5102  Val Acc:0.8097
Train and val complete in 2m 47s
Epoch [6/100]: 100%|███| 469/469 [00:28<00:00, 16.73it/s, acc=0.777, loss=0.619]
Train Loss:0.6189  Train Acc: 0.7766
Val Loss:0.4885  Val Acc:0.8183
Train and val complete in 3m 16s
Epoch [7/100]: 100%|███| 469/469 [00:28<00:00, 16.48it/s, acc=0.812, loss=0.516]
Train Loss:0.5161  Train Acc: 0.8120
Val Loss:0.4154  Val Acc:0.8472
Train and val complete in 3m 44s
Epoch [8/100]: 100%|████| 469/469 [00:27<00:00, 16.85it/s, acc=0.835, loss=0.44]
Train Loss:0.4396  Train Acc: 0.8354
Val Loss:0.3852  Val Acc:0.8595
Train and val complete in 4m 12s
Epoch [9/100]: 100%|███| 469/469 [00:28<00:00, 16.70it/s, acc=0.848, loss=0.409]
EarlyStopping counter: 1 out of 10
Train Loss:0.4093  Train Acc: 0.8476
Val Loss:0.4473  Val Acc:0.8243
Train and val complete in 4m 40s
Epoch [10/100]: 100%|██| 469/469 [00:28<00:00, 16.65it/s, acc=0.856, loss=0.389]
Train Loss:0.3888  Train Acc: 0.8557
Val Loss:0.3729  Val Acc:0.8646
Train and val complete in 5m 9s
Epoch [11/100]: 100%|██| 469/469 [00:27<00:00, 16.85it/s, acc=0.857, loss=0.384]
Train Loss:0.3844  Train Acc: 0.8573
Val Loss:0.3305  Val Acc:0.8776
Train and val complete in 5m 36s
Epoch [12/100]: 100%|██| 469/469 [00:28<00:00, 16.69it/s, acc=0.864, loss=0.364]
EarlyStopping counter: 1 out of 10
Train Loss:0.3639  Train Acc: 0.8643
Val Loss:0.3368  Val Acc:0.8772
Train and val complete in 6m 5s
Epoch [13/100]: 100%|███| 469/469 [00:28<00:00, 16.62it/s, acc=0.87, loss=0.352]
EarlyStopping counter: 2 out of 10
Train Loss:0.3519  Train Acc: 0.8698
Val Loss:0.3600  Val Acc:0.8662
Train and val complete in 6m 33s
Epoch [14/100]: 100%|██| 469/469 [00:28<00:00, 16.19it/s, acc=0.871, loss=0.347]
EarlyStopping counter: 3 out of 10
Epoch    15: reducing learning rate of group 0 to 1.2500e-02.
Train Loss:0.3474  Train Acc: 0.8712
Val Loss:0.3376  Val Acc:0.8695
Train and val complete in 7m 2s
Epoch [15/100]: 100%|██| 469/469 [00:28<00:00, 16.59it/s, acc=0.887, loss=0.305]
Train Loss:0.3054  Train Acc: 0.8868
Val Loss:0.2718  Val Acc:0.8959
Train and val complete in 7m 30s
Epoch [16/100]: 100%|██| 469/469 [00:28<00:00, 16.61it/s, acc=0.891, loss=0.294]
EarlyStopping counter: 1 out of 10
Train Loss:0.2943  Train Acc: 0.8910
Val Loss:0.2759  Val Acc:0.8994
Train and val complete in 7m 59s
Epoch [17/100]: 100%|██| 469/469 [00:28<00:00, 16.49it/s, acc=0.893, loss=0.291]
Train Loss:0.2906  Train Acc: 0.8927
Val Loss:0.2682  Val Acc:0.9008
Train and val complete in 8m 27s
Epoch [18/100]: 100%|██| 469/469 [00:28<00:00, 16.65it/s, acc=0.894, loss=0.287]
EarlyStopping counter: 1 out of 10
Train Loss:0.2872  Train Acc: 0.8939
Val Loss:0.2772  Val Acc:0.8985
Train and val complete in 8m 56s
Epoch [19/100]: 100%|██| 469/469 [00:27<00:00, 16.83it/s, acc=0.894, loss=0.283]
EarlyStopping counter: 2 out of 10
Train Loss:0.2826  Train Acc: 0.8942
Val Loss:0.2727  Val Acc:0.8998
Train and val complete in 9m 24s
Epoch [20/100]: 100%|██| 469/469 [00:27<00:00, 16.99it/s, acc=0.895, loss=0.281]
Train Loss:0.2811  Train Acc: 0.8949
Val Loss:0.2621  Val Acc:0.9027
Train and val complete in 9m 51s
Epoch [21/100]: 100%|██| 469/469 [00:29<00:00, 16.01it/s, acc=0.895, loss=0.281]
Train Loss:0.2808  Train Acc: 0.8948
Val Loss:0.2492  Val Acc:0.9081
Train and val complete in 10m 21s
Epoch [22/100]: 100%|███| 469/469 [00:28<00:00, 16.45it/s, acc=0.896, loss=0.28]
EarlyStopping counter: 1 out of 10
Train Loss:0.2796  Train Acc: 0.8960
Val Loss:0.2528  Val Acc:0.9058
Train and val complete in 10m 49s
Epoch [23/100]: 100%|██| 469/469 [00:27<00:00, 16.76it/s, acc=0.896, loss=0.278]
Train Loss:0.2777  Train Acc: 0.8964
Val Loss:0.2455  Val Acc:0.9070
Train and val complete in 11m 17s
Epoch [24/100]: 100%|██| 469/469 [00:28<00:00, 16.37it/s, acc=0.899, loss=0.274]
Train Loss:0.2742  Train Acc: 0.8994
Val Loss:0.2449  Val Acc:0.9101
Train and val complete in 11m 46s
Epoch [25/100]: 100%|████| 469/469 [00:28<00:00, 16.74it/s, acc=0.9, loss=0.269]
EarlyStopping counter: 1 out of 10
Train Loss:0.2688  Train Acc: 0.9003
Val Loss:0.2540  Val Acc:0.9087
Train and val complete in 12m 14s
Epoch [26/100]: 100%|██| 469/469 [00:28<00:00, 16.65it/s, acc=0.902, loss=0.265]
EarlyStopping counter: 2 out of 10
Train Loss:0.2654  Train Acc: 0.9016
Val Loss:0.2509  Val Acc:0.9033
Train and val complete in 12m 42s
Epoch [27/100]: 100%|██| 469/469 [00:25<00:00, 18.59it/s, acc=0.902, loss=0.264]
EarlyStopping counter: 3 out of 10
Epoch    28: reducing learning rate of group 0 to 3.1250e-03.
Train Loss:0.2636  Train Acc: 0.9018
Val Loss:0.2477  Val Acc:0.9062
Train and val complete in 13m 8s
Epoch [28/100]: 100%|██| 469/469 [00:27<00:00, 16.78it/s, acc=0.906, loss=0.252]
Train Loss:0.2516  Train Acc: 0.9060
Val Loss:0.2352  Val Acc:0.9138
Train and val complete in 13m 36s
Epoch [29/100]: 100%|██| 469/469 [00:27<00:00, 16.81it/s, acc=0.907, loss=0.251]
Train Loss:0.2508  Train Acc: 0.9072
Val Loss:0.2295  Val Acc:0.9156
Train and val complete in 14m 4s
Epoch [30/100]: 100%|██| 469/469 [00:28<00:00, 16.69it/s, acc=0.907, loss=0.251]
EarlyStopping counter: 1 out of 10
Train Loss:0.2508  Train Acc: 0.9066
Val Loss:0.2302  Val Acc:0.9167
Train and val complete in 14m 32s
Epoch [31/100]: 100%|███| 469/469 [00:28<00:00, 16.58it/s, acc=0.908, loss=0.25]
Train Loss:0.2499  Train Acc: 0.9078
Val Loss:0.2228  Val Acc:0.9173
Train and val complete in 15m 0s
Epoch [32/100]: 100%|██| 469/469 [00:28<00:00, 16.37it/s, acc=0.909, loss=0.247]
EarlyStopping counter: 1 out of 10
Train Loss:0.2474  Train Acc: 0.9092
Val Loss:0.2316  Val Acc:0.9128
Train and val complete in 15m 29s
Epoch [33/100]: 100%|██| 469/469 [00:27<00:00, 16.78it/s, acc=0.907, loss=0.246]
EarlyStopping counter: 2 out of 10
Train Loss:0.2461  Train Acc: 0.9073
Val Loss:0.2238  Val Acc:0.9173
Train and val complete in 15m 57s
Epoch [34/100]: 100%|███| 469/469 [00:28<00:00, 16.45it/s, acc=0.91, loss=0.244]
EarlyStopping counter: 3 out of 10
Epoch    35: reducing learning rate of group 0 to 7.8125e-04.
Train Loss:0.2436  Train Acc: 0.9102
Val Loss:0.2255  Val Acc:0.9157
Train and val complete in 16m 26s
Epoch [35/100]: 100%|███| 469/469 [00:28<00:00, 16.39it/s, acc=0.91, loss=0.246]
Train Loss:0.2456  Train Acc: 0.9097
Val Loss:0.2110  Val Acc:0.9242
Train and val complete in 16m 55s
Epoch [36/100]: 100%|██| 469/469 [00:27<00:00, 16.84it/s, acc=0.908, loss=0.244]
EarlyStopping counter: 1 out of 10
Train Loss:0.2440  Train Acc: 0.9078
Val Loss:0.2181  Val Acc:0.9235
Train and val complete in 17m 22s
Epoch [37/100]: 100%|███| 469/469 [00:28<00:00, 16.60it/s, acc=0.912, loss=0.24]
EarlyStopping counter: 2 out of 10
Train Loss:0.2401  Train Acc: 0.9115
Val Loss:0.2267  Val Acc:0.9153
Train and val complete in 17m 51s
Epoch [38/100]: 100%|███| 469/469 [00:28<00:00, 16.54it/s, acc=0.91, loss=0.241]
EarlyStopping counter: 3 out of 10
Epoch    39: reducing learning rate of group 0 to 1.9531e-04.
Train Loss:0.2415  Train Acc: 0.9104
Val Loss:0.2117  Val Acc:0.9231
Train and val complete in 18m 19s
Epoch [39/100]: 100%|████| 469/469 [00:27<00:00, 16.84it/s, acc=0.91, loss=0.24]
EarlyStopping counter: 4 out of 10
Train Loss:0.2402  Train Acc: 0.9099
Val Loss:0.2160  Val Acc:0.9195
Train and val complete in 18m 47s
Epoch [40/100]: 100%|██| 469/469 [00:28<00:00, 16.56it/s, acc=0.911, loss=0.239]
EarlyStopping counter: 5 out of 10
Train Loss:0.2386  Train Acc: 0.9107
Val Loss:0.2194  Val Acc:0.9179
Train and val complete in 19m 16s
Epoch [41/100]: 100%|██| 469/469 [00:28<00:00, 16.48it/s, acc=0.909, loss=0.245]
Train Loss:0.2450  Train Acc: 0.9089
Val Loss:0.1976  Val Acc:0.9266
Train and val complete in 19m 44s
Epoch [42/100]: 100%|████| 469/469 [00:27<00:00, 17.03it/s, acc=0.91, loss=0.24]
EarlyStopping counter: 1 out of 10
Train Loss:0.2404  Train Acc: 0.9099
Val Loss:0.2173  Val Acc:0.9198
Train and val complete in 20m 12s
Epoch [43/100]: 100%|██| 469/469 [00:28<00:00, 16.64it/s, acc=0.912, loss=0.239]
EarlyStopping counter: 2 out of 10
Train Loss:0.2388  Train Acc: 0.9116
Val Loss:0.2102  Val Acc:0.9219
Train and val complete in 20m 40s
Epoch [44/100]: 100%|████| 469/469 [00:28<00:00, 16.54it/s, acc=0.91, loss=0.24]
EarlyStopping counter: 3 out of 10
Epoch    45: reducing learning rate of group 0 to 4.8828e-05.
Train Loss:0.2399  Train Acc: 0.9100
Val Loss:0.2204  Val Acc:0.9182
Train and val complete in 21m 9s
Epoch [45/100]: 100%|██| 469/469 [00:28<00:00, 16.34it/s, acc=0.912, loss=0.237]
EarlyStopping counter: 4 out of 10
Train Loss:0.2375  Train Acc: 0.9122
Val Loss:0.2232  Val Acc:0.9167
Train and val complete in 21m 37s
Epoch [46/100]: 100%|██| 469/469 [00:29<00:00, 16.01it/s, acc=0.912, loss=0.236]
EarlyStopping counter: 5 out of 10
Train Loss:0.2359  Train Acc: 0.9124
Val Loss:0.2277  Val Acc:0.9153
Train and val complete in 22m 7s
Epoch [47/100]: 100%|███| 469/469 [00:29<00:00, 16.04it/s, acc=0.911, loss=0.24]
EarlyStopping counter: 6 out of 10
Epoch    48: reducing learning rate of group 0 to 1.2207e-05.
Train Loss:0.2402  Train Acc: 0.9112
Val Loss:0.2102  Val Acc:0.9226
Train and val complete in 22m 36s
Epoch [48/100]: 100%|███| 469/469 [00:28<00:00, 16.45it/s, acc=0.911, loss=0.24]
EarlyStopping counter: 7 out of 10
Train Loss:0.2404  Train Acc: 0.9110
Val Loss:0.2109  Val Acc:0.9218
Train and val complete in 23m 5s
Epoch [49/100]: 100%|███| 469/469 [00:27<00:00, 16.87it/s, acc=0.911, loss=0.24]
EarlyStopping counter: 8 out of 10
Train Loss:0.2399  Train Acc: 0.9106
Val Loss:0.2102  Val Acc:0.9215
Train and val complete in 23m 33s
Epoch [50/100]: 100%|████| 469/469 [00:28<00:00, 16.63it/s, acc=0.91, loss=0.24]
EarlyStopping counter: 9 out of 10
Epoch    51: reducing learning rate of group 0 to 3.0518e-06.
Train Loss:0.2398  Train Acc: 0.9103
Val Loss:0.2177  Val Acc:0.9205
Train and val complete in 24m 1s
Epoch [51/100]: 100%|██| 469/469 [00:28<00:00, 16.37it/s, acc=0.912, loss=0.238]
EarlyStopping counter: 10 out of 10
Early stopping
    epoch  train_loss  val_loss  train_acc   val_acc
0       0    2.266121  2.120792   0.140354  0.254167
1       1    1.909557  2.312427   0.277062  0.103250
2       2    1.353021  0.739213   0.487083  0.719917
3       3    0.703969  0.563291   0.733917  0.789917
4       4    1.350438  0.696051   0.511875  0.720583
5       5    0.655020  0.510182   0.758625  0.809750
6       6    0.618939  0.488460   0.776583  0.818250
7       7    0.516089  0.415351   0.812021  0.847250
8       8    0.439579  0.385221   0.835417  0.859500
9       9    0.409262  0.447286   0.847562  0.824250
10     10    0.388816  0.372862   0.855667  0.864583
11     11    0.384422  0.330479   0.857313  0.877583
12     12    0.363896  0.336813   0.864313  0.877250
13     13    0.351949  0.359953   0.869833  0.866167
14     14    0.347420  0.337621   0.871167  0.869500
15     15    0.305416  0.271830   0.886771  0.895917
16     16    0.294297  0.275868   0.890979  0.899417
17     17    0.290554  0.268189   0.892687  0.900833
18     18    0.287239  0.277175   0.893875  0.898500
19     19    0.282622  0.272711   0.894188  0.899833
20     20    0.281056  0.262147   0.894938  0.902667
21     21    0.280771  0.249187   0.894750  0.908083
22     22    0.279631  0.252797   0.895979  0.905750
23     23    0.277657  0.245472   0.896437  0.907000
24     24    0.274189  0.244949   0.899375  0.910083
25     25    0.268816  0.253986   0.900333  0.908750
26     26    0.265395  0.250945   0.901563  0.903333
27     27    0.263622  0.247740   0.901792  0.906167
28     28    0.251631  0.235237   0.905979  0.913833
29     29    0.250785  0.229471   0.907167  0.915583
30     30    0.250794  0.230218   0.906563  0.916667
31     31    0.249860  0.222762   0.907833  0.917250
32     32    0.247434  0.231576   0.909188  0.912833
33     33    0.246134  0.223832   0.907312  0.917333
34     34    0.243554  0.225458   0.910167  0.915750
35     35    0.245570  0.210950   0.909708  0.924167
36     36    0.243978  0.218062   0.907813  0.923500
37     37    0.240098  0.226711   0.911542  0.915250
38     38    0.241489  0.211668   0.910438  0.923083
39     39    0.240186  0.216005   0.909875  0.919500
40     40    0.238590  0.219422   0.910750  0.917917
41     41    0.244968  0.197566   0.908896  0.926583
42     42    0.240433  0.217303   0.909937  0.919833
43     43    0.238790  0.210185   0.911604  0.921917
44     44    0.239868  0.220411   0.910042  0.918167
45     45    0.237456  0.223215   0.912208  0.916667
46     46    0.235856  0.227667   0.912396  0.915333
47     47    0.240153  0.210154   0.911229  0.922583
48     48    0.240435  0.210948   0.911000  0.921833
49     49    0.239858  0.210168   0.910563  0.921500
50     50    0.239846  0.217724   0.910292  0.920500
test acc 0.895