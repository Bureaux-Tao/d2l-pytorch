Sequential(
  (0): Conv2d(1, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3))
  (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (2): ReLU()
  (3): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
  (4): Sequential(
    (0): Residual(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
    )
    (1): Residual(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
    )
  )
  (5): Sequential(
    (0): Residual(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (conv3): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2))
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
    )
    (1): Residual(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
    )
  )
  (6): Sequential(
    (0): Residual(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (conv3): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2))
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
    )
    (1): Residual(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
    )
  )
  (7): Sequential(
    (0): Residual(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (conv3): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2))
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
    )
    (1): Residual(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
    )
  )
  (8): AdaptiveAvgPool2d(output_size=(1, 1))
  (9): Flatten()
  (10): Linear(in_features=512, out_features=10, bias=True)
)
Conv2d          output shape:	 torch.Size([1, 64, 112, 112])
BatchNorm2d     output shape:	 torch.Size([1, 64, 112, 112])
ReLU            output shape:	 torch.Size([1, 64, 112, 112])
MaxPool2d       output shape:	 torch.Size([1, 64, 56, 56])
Sequential      output shape:	 torch.Size([1, 64, 56, 56])
Sequential      output shape:	 torch.Size([1, 128, 28, 28])
Sequential      output shape:	 torch.Size([1, 256, 14, 14])
Sequential      output shape:	 torch.Size([1, 512, 7, 7])
AdaptiveAvgPool2d output shape:	 torch.Size([1, 512, 1, 1])
Flatten         output shape:	 torch.Size([1, 512])
Linear          output shape:	 torch.Size([1, 10])
training on cuda:0
Epoch [1/40]: 100%|████| 235/235 [00:52<00:00,  4.49it/s, acc=0.764, loss=0.678]
+-------+--------+----------+--------+---------+----------+
| epoch |  loss  | val loss |  acc   | val acc | test acc |
+-------+--------+----------+--------+---------+----------+
|   1   | 0.6781 |  0.4612  | 0.7638 |  0.8288 |  0.8255  |
+-------+--------+----------+--------+---------+----------+
Epoch [2/40]: 100%|█████| 235/235 [00:52<00:00,  4.47it/s, acc=0.88, loss=0.324]
+-------+--------+----------+--------+---------+----------+
| epoch |  loss  | val loss |  acc   | val acc | test acc |
+-------+--------+----------+--------+---------+----------+
|   2   | 0.3241 |  0.3125  | 0.8803 |  0.8881 |  0.8849  |
+-------+--------+----------+--------+---------+----------+
Epoch [3/40]: 100%|████| 235/235 [00:59<00:00,  3.95it/s, acc=0.907, loss=0.256]
+-------+--------+----------+--------+---------+----------+
| epoch |  loss  | val loss |  acc   | val acc | test acc |
+-------+--------+----------+--------+---------+----------+
|   3   | 0.2564 |  0.3567  | 0.9067 |  0.8737 |  0.8669  |
+-------+--------+----------+--------+---------+----------+
EarlyStopping counter: 1 out of 5
Epoch [4/40]: 100%|█████| 235/235 [01:08<00:00,  3.45it/s, acc=0.92, loss=0.218]
+-------+-------+----------+--------+---------+----------+
| epoch |  loss | val loss |  acc   | val acc | test acc |
+-------+-------+----------+--------+---------+----------+
|   4   | 0.218 |  0.2272  | 0.9203 |  0.9187 |  0.9043  |
+-------+-------+----------+--------+---------+----------+
Epoch [5/40]: 100%|████| 235/235 [01:10<00:00,  3.31it/s, acc=0.932, loss=0.187]
+-------+--------+----------+--------+---------+----------+
| epoch |  loss  | val loss |  acc   | val acc | test acc |
+-------+--------+----------+--------+---------+----------+
|   5   | 0.1874 |  0.249   | 0.9321 |  0.9078 |  0.8901  |
+-------+--------+----------+--------+---------+----------+
EarlyStopping counter: 1 out of 5
Epoch [6/40]: 100%|████| 235/235 [01:12<00:00,  3.26it/s, acc=0.943, loss=0.161]
+-------+--------+----------+-------+---------+----------+
| epoch |  loss  | val loss |  acc  | val acc | test acc |
+-------+--------+----------+-------+---------+----------+
|   6   | 0.1609 |  0.2431  | 0.943 |  0.9116 |  0.8889  |
+-------+--------+----------+-------+---------+----------+
EarlyStopping counter: 2 out of 5
Epoch [7/40]: 100%|████| 235/235 [01:12<00:00,  3.24it/s, acc=0.953, loss=0.134]
+-------+--------+----------+-------+---------+----------+
| epoch |  loss  | val loss |  acc  | val acc | test acc |
+-------+--------+----------+-------+---------+----------+
|   7   | 0.1341 |  0.1899  | 0.953 |  0.9336 |  0.9048  |
+-------+--------+----------+-------+---------+----------+
Epoch [8/40]: 100%|████| 235/235 [01:12<00:00,  3.26it/s, acc=0.963, loss=0.107]
+-------+--------+----------+--------+---------+----------+
| epoch |  loss  | val loss |  acc   | val acc | test acc |
+-------+--------+----------+--------+---------+----------+
|   8   | 0.1075 |  0.1275  | 0.9625 |  0.9532 |  0.9102  |
+-------+--------+----------+--------+---------+----------+
Epoch [9/40]: 100%|███| 235/235 [01:14<00:00,  3.15it/s, acc=0.971, loss=0.0863]
+-------+--------+----------+--------+---------+----------+
| epoch |  loss  | val loss |  acc   | val acc | test acc |
+-------+--------+----------+--------+---------+----------+
|   9   | 0.0863 |  1.4101  | 0.9711 |  0.6459 |  0.6309  |
+-------+--------+----------+--------+---------+----------+
EarlyStopping counter: 1 out of 5
Epoch [10/40]: 100%|██| 235/235 [01:13<00:00,  3.21it/s, acc=0.978, loss=0.0655]
+-------+--------+----------+--------+---------+----------+
| epoch |  loss  | val loss |  acc   | val acc | test acc |
+-------+--------+----------+--------+---------+----------+
|   10  | 0.0655 |  0.1015  | 0.9781 |  0.9629 |  0.9108  |
+-------+--------+----------+--------+---------+----------+
Epoch [11/40]: 100%|██| 235/235 [01:12<00:00,  3.22it/s, acc=0.986, loss=0.0474]
+-------+--------+----------+--------+---------+----------+
| epoch |  loss  | val loss |  acc   | val acc | test acc |
+-------+--------+----------+--------+---------+----------+
|   11  | 0.0474 |  0.085   | 0.9863 |  0.9711 |  0.9058  |
+-------+--------+----------+--------+---------+----------+
Epoch [12/40]: 100%|██| 235/235 [01:12<00:00,  3.22it/s, acc=0.991, loss=0.0305]
+-------+--------+----------+--------+---------+----------+
| epoch |  loss  | val loss |  acc   | val acc | test acc |
+-------+--------+----------+--------+---------+----------+
|   12  | 0.0305 |  0.2284  | 0.9914 |  0.9248 |  0.869   |
+-------+--------+----------+--------+---------+----------+
EarlyStopping counter: 1 out of 5
Epoch [13/40]: 100%|██| 235/235 [01:12<00:00,  3.26it/s, acc=0.996, loss=0.0192]
+-------+--------+----------+--------+---------+----------+
| epoch |  loss  | val loss |  acc   | val acc | test acc |
+-------+--------+----------+--------+---------+----------+
|   13  | 0.0192 |  0.0387  | 0.9956 |  0.9869 |  0.9147  |
+-------+--------+----------+--------+---------+----------+
Epoch [14/40]: 100%|█| 235/235 [01:14<00:00,  3.17it/s, acc=0.999, loss=0.00943]
+-------+--------+----------+--------+---------+----------+
| epoch |  loss  | val loss |  acc   | val acc | test acc |
+-------+--------+----------+--------+---------+----------+
|   14  | 0.0094 |  0.0068  | 0.9987 |  0.9992 |  0.9259  |
+-------+--------+----------+--------+---------+----------+
Epoch [15/40]: 100%|█████| 235/235 [01:12<00:00,  3.22it/s, acc=1, loss=0.00415]
+-------+--------+----------+--------+---------+----------+
| epoch |  loss  | val loss |  acc   | val acc | test acc |
+-------+--------+----------+--------+---------+----------+
|   15  | 0.0041 |  0.0031  | 0.9997 |  0.9998 |  0.9264  |
+-------+--------+----------+--------+---------+----------+
Epoch [16/40]: 100%|█████| 235/235 [01:14<00:00,  3.17it/s, acc=1, loss=0.00219]
+-------+--------+----------+-----+---------+----------+
| epoch |  loss  | val loss | acc | val acc | test acc |
+-------+--------+----------+-----+---------+----------+
|   16  | 0.0022 |  0.0017  | 1.0 |   1.0   |  0.9288  |
+-------+--------+----------+-----+---------+----------+
Epoch [17/40]: 100%|█████| 235/235 [01:13<00:00,  3.21it/s, acc=1, loss=0.00146]
+-------+--------+----------+-----+---------+----------+
| epoch |  loss  | val loss | acc | val acc | test acc |
+-------+--------+----------+-----+---------+----------+
|   17  | 0.0015 |  0.0011  | 1.0 |   1.0   |  0.9288  |
+-------+--------+----------+-----+---------+----------+
Epoch [18/40]: 100%|█████| 235/235 [01:11<00:00,  3.27it/s, acc=1, loss=0.00109]
+-------+--------+----------+-----+---------+----------+
| epoch |  loss  | val loss | acc | val acc | test acc |
+-------+--------+----------+-----+---------+----------+
|   18  | 0.0011 |  0.0009  | 1.0 |   1.0   |  0.9284  |
+-------+--------+----------+-----+---------+----------+
Epoch [19/40]: 100%|████| 235/235 [01:13<00:00,  3.20it/s, acc=1, loss=0.000958]
+-------+-------+----------+-----+---------+----------+
| epoch |  loss | val loss | acc | val acc | test acc |
+-------+-------+----------+-----+---------+----------+
|   19  | 0.001 |  0.0007  | 1.0 |   1.0   |  0.9285  |
+-------+-------+----------+-----+---------+----------+
Epoch [20/40]: 100%|████| 235/235 [01:13<00:00,  3.19it/s, acc=1, loss=0.000796]
+-------+--------+----------+-----+---------+----------+
| epoch |  loss  | val loss | acc | val acc | test acc |
+-------+--------+----------+-----+---------+----------+
|   20  | 0.0008 |  0.0006  | 1.0 |   1.0   |  0.9275  |
+-------+--------+----------+-----+---------+----------+
Epoch [21/40]: 100%|████| 235/235 [01:12<00:00,  3.26it/s, acc=1, loss=0.000728]
+-------+--------+----------+-----+---------+----------+
| epoch |  loss  | val loss | acc | val acc | test acc |
+-------+--------+----------+-----+---------+----------+
|   21  | 0.0007 |  0.0005  | 1.0 |   1.0   |  0.9278  |
+-------+--------+----------+-----+---------+----------+
Epoch [22/40]: 100%|████| 235/235 [01:13<00:00,  3.21it/s, acc=1, loss=0.000652]
+-------+--------+----------+-----+---------+----------+
| epoch |  loss  | val loss | acc | val acc | test acc |
+-------+--------+----------+-----+---------+----------+
|   22  | 0.0007 |  0.0004  | 1.0 |   1.0   |  0.9278  |
+-------+--------+----------+-----+---------+----------+
Epoch [23/40]: 100%|████| 235/235 [01:13<00:00,  3.20it/s, acc=1, loss=0.000573]
+-------+--------+----------+-----+---------+----------+
| epoch |  loss  | val loss | acc | val acc | test acc |
+-------+--------+----------+-----+---------+----------+
|   23  | 0.0006 |  0.0004  | 1.0 |   1.0   |  0.928   |
+-------+--------+----------+-----+---------+----------+
Epoch [24/40]: 100%|████| 235/235 [01:14<00:00,  3.15it/s, acc=1, loss=0.000546]
+-------+--------+----------+-----+---------+----------+
| epoch |  loss  | val loss | acc | val acc | test acc |
+-------+--------+----------+-----+---------+----------+
|   24  | 0.0005 |  0.0004  | 1.0 |   1.0   |  0.9277  |
+-------+--------+----------+-----+---------+----------+
Epoch [25/40]: 100%|████| 235/235 [01:14<00:00,  3.15it/s, acc=1, loss=0.000509]
+-------+--------+----------+-----+---------+----------+
| epoch |  loss  | val loss | acc | val acc | test acc |
+-------+--------+----------+-----+---------+----------+
|   25  | 0.0005 |  0.0003  | 1.0 |   1.0   |  0.9272  |
+-------+--------+----------+-----+---------+----------+
Epoch [26/40]: 100%|████| 235/235 [01:12<00:00,  3.26it/s, acc=1, loss=0.000457]
+-------+--------+----------+-----+---------+----------+
| epoch |  loss  | val loss | acc | val acc | test acc |
+-------+--------+----------+-----+---------+----------+
|   26  | 0.0005 |  0.0003  | 1.0 |   1.0   |  0.9283  |
+-------+--------+----------+-----+---------+----------+
Epoch [27/40]: 100%|████| 235/235 [01:13<00:00,  3.19it/s, acc=1, loss=0.000443]
+-------+--------+----------+-----+---------+----------+
| epoch |  loss  | val loss | acc | val acc | test acc |
+-------+--------+----------+-----+---------+----------+
|   27  | 0.0004 |  0.0003  | 1.0 |   1.0   |  0.9281  |
+-------+--------+----------+-----+---------+----------+
EarlyStopping counter: 1 out of 5
Epoch [28/40]: 100%|████| 235/235 [01:14<00:00,  3.15it/s, acc=1, loss=0.000406]
+-------+--------+----------+-----+---------+----------+
| epoch |  loss  | val loss | acc | val acc | test acc |
+-------+--------+----------+-----+---------+----------+
|   28  | 0.0004 |  0.0003  | 1.0 |   1.0   |  0.9278  |
+-------+--------+----------+-----+---------+----------+
Epoch [29/40]: 100%|████| 235/235 [01:13<00:00,  3.21it/s, acc=1, loss=0.000385]
+-------+--------+----------+-----+---------+----------+
| epoch |  loss  | val loss | acc | val acc | test acc |
+-------+--------+----------+-----+---------+----------+
|   29  | 0.0004 |  0.0003  | 1.0 |   1.0   |  0.9279  |
+-------+--------+----------+-----+---------+----------+
Epoch [30/40]: 100%|████| 235/235 [01:13<00:00,  3.21it/s, acc=1, loss=0.000367]
+-------+--------+----------+-----+---------+----------+
| epoch |  loss  | val loss | acc | val acc | test acc |
+-------+--------+----------+-----+---------+----------+
|   30  | 0.0004 |  0.0002  | 1.0 |   1.0   |  0.9281  |
+-------+--------+----------+-----+---------+----------+
Epoch [31/40]: 100%|████| 235/235 [01:10<00:00,  3.32it/s, acc=1, loss=0.000331]
+-------+--------+----------+-----+---------+----------+
| epoch |  loss  | val loss | acc | val acc | test acc |
+-------+--------+----------+-----+---------+----------+
|   31  | 0.0003 |  0.0002  | 1.0 |   1.0   |  0.9282  |
+-------+--------+----------+-----+---------+----------+
Epoch [32/40]: 100%|████| 235/235 [01:12<00:00,  3.22it/s, acc=1, loss=0.000318]
+-------+--------+----------+-----+---------+----------+
| epoch |  loss  | val loss | acc | val acc | test acc |
+-------+--------+----------+-----+---------+----------+
|   32  | 0.0003 |  0.0002  | 1.0 |   1.0   |  0.9274  |
+-------+--------+----------+-----+---------+----------+
Epoch [33/40]: 100%|████| 235/235 [01:13<00:00,  3.20it/s, acc=1, loss=0.000306]
+-------+--------+----------+-----+---------+----------+
| epoch |  loss  | val loss | acc | val acc | test acc |
+-------+--------+----------+-----+---------+----------+
|   33  | 0.0003 |  0.0002  | 1.0 |   1.0   |  0.9282  |
+-------+--------+----------+-----+---------+----------+
Epoch [34/40]: 100%|██████| 235/235 [00:54<00:00,  4.34it/s, acc=1, loss=0.000294]
+-------+--------+----------+-----+---------+----------+
| epoch |  loss  | val loss | acc | val acc | test acc |
+-------+--------+----------+-----+---------+----------+
|   34  | 0.0003 |  0.0002  | 1.0 |   1.0   |  0.9282  |
+-------+--------+----------+-----+---------+----------+
Epoch [35/40]: 100%|██████| 235/235 [01:09<00:00,  3.39it/s, acc=1, loss=0.000289]
+-------+--------+----------+-----+---------+----------+
| epoch |  loss  | val loss | acc | val acc | test acc |
+-------+--------+----------+-----+---------+----------+
|   35  | 0.0003 |  0.0002  | 1.0 |   1.0   |  0.9282  |
+-------+--------+----------+-----+---------+----------+
Epoch [36/40]: 100%|██████| 235/235 [01:12<00:00,  3.26it/s, acc=1, loss=0.000295]
+-------+--------+----------+-----+---------+----------+
| epoch |  loss  | val loss | acc | val acc | test acc |
+-------+--------+----------+-----+---------+----------+
|   36  | 0.0003 |  0.0002  | 1.0 |   1.0   |  0.9282  |
+-------+--------+----------+-----+---------+----------+
Epoch [37/40]: 100%|██████| 235/235 [01:12<00:00,  3.23it/s, acc=1, loss=0.000291]
+-------+--------+----------+-----+---------+----------+
| epoch |  loss  | val loss | acc | val acc | test acc |
+-------+--------+----------+-----+---------+----------+
|   37  | 0.0003 |  0.0002  | 1.0 |   1.0   |  0.928   |
+-------+--------+----------+-----+---------+----------+
Epoch [38/40]: 100%|██████| 235/235 [01:14<00:00,  3.15it/s, acc=1, loss=0.000276]
+-------+--------+----------+-----+---------+----------+
| epoch |  loss  | val loss | acc | val acc | test acc |
+-------+--------+----------+-----+---------+----------+
|   38  | 0.0003 |  0.0002  | 1.0 |   1.0   |  0.9273  |
+-------+--------+----------+-----+---------+----------+
Epoch [39/40]: 100%|██████| 235/235 [01:12<00:00,  3.24it/s, acc=1, loss=0.000277]
+-------+--------+----------+-----+---------+----------+
| epoch |  loss  | val loss | acc | val acc | test acc |
+-------+--------+----------+-----+---------+----------+
|   39  | 0.0003 |  0.0002  | 1.0 |   1.0   |  0.928   |
+-------+--------+----------+-----+---------+----------+
Epoch [40/40]: 100%|███████| 235/235 [01:13<00:00,  3.19it/s, acc=1, loss=0.00028]
+-------+--------+----------+-----+---------+----------+
| epoch |  loss  | val loss | acc | val acc | test acc |
+-------+--------+----------+-----+---------+----------+
|   40  | 0.0003 |  0.0002  | 1.0 |   1.0   |  0.9276  |
+-------+--------+----------+-----+---------+----------+
EarlyStopping counter: 1 out of 5

100%|███████████████████████████████████████████| 40/40 [00:04<00:00,  9.96it/s]
Test Loss:0.3216  Test Acc:0.9282